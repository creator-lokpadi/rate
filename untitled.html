 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Perhitungan Harga Barang</title>
</head>
<body>
<table border="1" id="tabel_barang">
  <thead>
    <tr>
      <th>No</th>
      <th>Nama Barang</th>
      <th>Pcs</th>
      <th>Harga</th>
      <th>Jumlah dipesan</th>
      <th>Total</th>
      <th>Total Pcs</th>
    </tr>
  </thead>
  <tbody>
    <!-- Baris akan dimasukkan oleh JavaScript -->
  </tbody>
  <tfoot>
    <tr>
      <td colspan="5">Total keseluruhan</td>
      <td><span id="total_keseluruhan">0</span></td>
      <td><span id="total_pcs">0</span></td>
    </tr>
  </tfoot>
</table>

<button onclick="tambahkanBaris()">Tambah Barang</button>
<button onclick="resetTabel()">Reset Tabel</button>
<button onclick="simpanData()">Simpan</button>

<script>
  var dataBarang = [];

  function hitungTotal() {
    var totalSemua = 0;
    var totalPcs = 0;
    var tabel = document.getElementById("tabel_barang");
    for (var i = 1; i < tabel.rows.length - 1; i++) {
      var harga = parseInt(tabel.rows[i].cells[3].querySelector('input').value);
      var jumlah = parseInt(tabel.rows[i].cells[4].querySelector('input').value);
      var total = harga * jumlah;
      var pcs = parseInt(tabel.rows[i].cells[2].querySelector('input').value);
      tabel.rows[i].cells[5].innerHTML = total;
      tabel.rows[i].cells[6].innerHTML = pcs * jumlah;
      totalSemua += total;
      totalPcs += pcs * jumlah;
    }
    document.getElementById("total_keseluruhan").innerHTML = totalSemua;
    document.getElementById("total_pcs").innerHTML = totalPcs;
  }

  function tambahkanBaris() {
    var tabel = document.getElementById("tabel_barang");
    var nomorBaris = tabel.rows.length;
    var row = tabel.insertRow(nomorBaris - 1);
    row.innerHTML = `
      <td>${nomorBaris}</td>
      <td><input type="text" class="nama_barang" value="Barang baru" onchange="hitungTotal()"></td>
      <td><input type="number" class="pcs_barang" value="0" onchange="hitungTotal()"></td>
      <td><input type="number" class="harga_barang" value="0" onchange="hitungTotal()"></td>
      <td><input type="number" class="jumlah_barang" value="0" onchange="hitungTotal()"></td>
      <td>0</td>
      <td>0</td>
    `;
    hitungTotal();
  }

  function resetTabel() {
    var tabel = document.getElementById("tabel_barang");
    while (tabel.rows.length > 2) {
      tabel.deleteRow(1);
    }
    hitungTotal();
    localStorage.removeItem('dataBarang');
  }

  function simpanData() {
    var tabel = document.getElementById("tabel_barang");
    dataBarang = [];
    for (var i = 1; i < tabel.rows.length - 1; i++) {
      var nama = tabel.rows[i].cells[1].querySelector('input').value;
      var harga = parseInt(tabel.rows[i].cells[3].querySelector('input').value);
      var jumlah = parseInt(tabel.rows[i].cells[4].querySelector('input').value);
      var pcs = parseInt(tabel.rows[i].cells[2].querySelector('input').value);
      dataBarang.push({ nama: nama, harga: harga, jumlah: jumlah, pcs: pcs });
    }
    localStorage.setItem('dataBarang', JSON.stringify(dataBarang));
  }

  window.onload = function() {
    var savedData = localStorage.getItem('dataBarang');
    if (savedData) {
      dataBarang = JSON.parse(savedData);
      var tabel = document.getElementById("tabel_barang");
      for (var i = 0; i < dataBarang.length; i++) {
        var row = tabel.insertRow(tabel.rows.length - 1);
        row.innerHTML = `
          <td>${i + 1}</td>
          <td><input type="text" class="nama_barang" value="${dataBarang[i].nama}" onchange="hitungTotal()"></td>
          <td><input type="number" class="pcs_barang" value="${dataBarang[i].pcs}" onchange="hitungTotal()"></td>
          <td><input type="number" class="harga_barang" value="${dataBarang[i].harga}" onchange="hitungTotal()"></td>
          <td><input type="number" class="jumlah_barang" value="${dataBarang[i].jumlah}" onchange="hitungTotal()"></td>
          <td>${dataBarang[i].harga * dataBarang[i].jumlah}</td>
          <td>${dataBarang[i].pcs * dataBarang[i].jumlah}</td>
        `;
      }
      hitungTotal();
    }
  };
</script>
</body>
</html>
